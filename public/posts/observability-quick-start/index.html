<!doctype html>
<html
  lang="en"
  dir="ltr"
  class="scroll-smooth"
  data-default-appearance="light"
  data-auto-appearance="true"><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
  
    <meta http-equiv="content-language" content="en">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="theme-color">

  
  
    <title>Performance Tuning Quick Start: Metrics, Profiling & Beyond &middot; </title>
    <meta name="title" content="Performance Tuning Quick Start: Metrics, Profiling & Beyond &middot; ">
  

  
  
  
    <meta name="keywords" content="series,docs,">
  
  
  
  <link rel="canonical" href="http://localhost:1313/posts/observability-quick-start/">
  

  
  
    <meta name="author" content="Paweł Obrępalski">
  
  
    
      
        
          <link href="https://linkedin.com/in/obrepalski" rel="me">
        
      
    
      
        
          <link href="https://github.com/obrep" rel="me">
        
      
    
      
        
      
    
  

  
  <meta property="og:url" content="http://localhost:1313/posts/observability-quick-start/">
  <meta property="og:title" content="Performance Tuning Quick Start: Metrics, Profiling & Beyond">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-04-10T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-04-10T00:00:00+00:00">
    <meta property="article:tag" content="Series">
    <meta property="article:tag" content="Docs">
    <meta property="og:image" content="http://localhost:1313/posts/observability-quick-start/feature.jpg">
      <meta property="og:see_also" content="http://localhost:1313/posts/observability-and-guardrails/">
      <meta property="og:see_also" content="http://localhost:1313/posts/why-care-about-cost/">

  
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="http://localhost:1313/posts/observability-quick-start/feature.jpg">
  <meta name="twitter:title" content="Performance Tuning Quick Start: Metrics, Profiling & Beyond">

  
  
  
  
    
      
    
  
    
      
    
  
    
      
    
  
  
    
  

  
  
  
  
  
  

  

  
  
  
  
  
  
  
  
    
  
  
  <link
    type="text/css"
    rel="stylesheet"
    href="/css/main.bundle.min.b5bc3f4587655153415b7825fd1716f97df9c99f87c23f81146f4dd4f9f49f04ad031e3b5f0ee5c0416707a1455ca2cfa8fc1f3a19ece1486b0126dcd310a63e.css"
    integrity="sha512-tbw/RYdlUVNBW3gl/RcW&#43;X35yZ&#43;Hwj&#43;BFG9N1Pn0nwStAx47Xw7lwEFnB6FFXKLPqPwfOhns4UhrASbc0xCmPg==">

  
  
  <script
    type="text/javascript"
    src="/js/appearance.min.6f41174b3a05b680820fe08cadbfa5fb7a7ca347b76a0955cdc68b9d8aca1ce24f0547e138cea33bcc7904d551a90afcb1cc7f2d9fe8557075d501419046c08c.js"
    integrity="sha512-b0EXSzoFtoCCD&#43;CMrb&#43;l&#43;3p8o0e3aglVzcaLnYrKHOJPBUfhOM6jO8x5BNVRqQr8scx/LZ/oVXB11QFBkEbAjA=="></script>
  
  
  
  
  
  
    
    <script src="/lib/zoom/zoom.min.umd.a527109b68c082a70f3697716dd72a9d5aa8b545cf800cecbbc7399f2ca6f6e0ce3e431f2062b48bbfa47c9ea42822714060bef309be073f49b9c0e30d318d7b.js" integrity="sha512-pScQm2jAgqcPNpdxbdcqnVqotUXPgAzsu8c5nyym9uDOPkMfIGK0i7&#43;kfJ6kKCJxQGC&#43;8wm&#43;Bz9JucDjDTGNew=="></script>
  

  
  
  
    
  
  
    
  
  
    
  
  
  
  
  
    
    <script
      defer
      type="text/javascript"
      id="script-bundle"
      src="/js/main.bundle.min.bdda7dece6cbaf08deef7d254f7f842f3261c2524d247905127c9a20decc03f1011a2950048464c79272c1ce0705a49a41147f39f2b95163bb71d404b33263ef.js"
      integrity="sha512-vdp97ObLrwje730lT3&#43;ELzJhwlJNJHkFEnyaIN7MA/EBGilQBIRkx5Jywc4HBaSaQRR/OfK5UWO7cdQEszJj7w=="
      data-copy="Copy"
      data-copied="Copied"></script>
  

  
  
























  

  

  

  

  













  
  
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
  

  
  <script type="application/ld+json">
  [{
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Posts",
    "name": "Performance Tuning Quick Start: Metrics, Profiling \u0026 Beyond",
    "headline": "Performance Tuning Quick Start: Metrics, Profiling \u0026 Beyond",
    
    "inLanguage": "en",
    "url" : "http://localhost:1313/posts/observability-quick-start/",
    "author" : {
      "@type": "Person",
      "name": "Paweł Obrępalski"
    },
    "copyrightYear": "2025",
    "dateCreated": "2025-04-10T00:00:00\u002b00:00",
    "datePublished": "2025-04-10T00:00:00\u002b00:00",
    
    "dateModified": "2025-04-10T00:00:00\u002b00:00",
    
    "keywords": ["series","docs"],
    
    "mainEntityOfPage": "true",
    "wordCount": "3579"
  }]
  </script>



  
  

  
  

  
  

  
  
</head>


















  
  <body class="flex flex-col h-screen m-auto leading-7 max-w-7xl px-6 sm:px-14 md:px-24 lg:px-32 text-lg bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral bf-scrollbar">
    <div id="the-top" class="absolute flex self-center">
      <a
        class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600"
        href="#main-content">
        <span class="font-bold text-primary-600 pe-2 dark:text-primary-400">&darr;</span>
        Skip to main content
      </a>
    </div>
    
    
      <div class="main-menu flex items-center w-full gap-2 p-1 pl-0">
  
  
    <a href="/" class="text-base font-medium truncate min-w-0 shrink">
      
    </a>
  
  <div class="flex items-center ms-auto">
    <div class="hidden md:flex">
      <nav class="flex items-center gap-x-5 h-12">
  
    
      
  
    <a
      href="/posts/"
      
      class="flex items-center bf-icon-color-hover"
      aria-label="Blog"
      title="Posts">
      
      
        <span class="text-base font-medium break-normal">
          Blog
        </span>
      
    </a>
  

    
      
  
    <a
      href="/about/"
      
      class="flex items-center bf-icon-color-hover"
      aria-label="About"
      title="About">
      
      
        <span class="text-base font-medium break-normal">
          About
        </span>
      
    </a>
  

    
  

  

  

  
    <button
      id="search-button"
      aria-label="Search"
      class="text-base bf-icon-color-hover"
      title="Search (/)">
      <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
    </button>
  

  
    <div class="flex items-center">
      <button
        id="appearance-switcher"
        aria-label="Dark mode switcher"
        type="button"
        class="text-base bf-icon-color-hover">
        <div class="flex items-center justify-center dark:hidden">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>
</span>
        </div>
        <div class="items-center justify-center hidden dark:flex">
          <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>
</span>
        </div>
      </button>
    </div>
  
</nav>



    </div>
    <div class="flex md:hidden">
      <div class="flex items-center h-14 gap-4">
  
    <button
      id="search-button-mobile"
      aria-label="Search"
      class="flex items-center justify-center bf-icon-color-hover"
      title="Search (/)">
      <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
    </button>
  

  
    <button
      id="appearance-switcher-mobile"
      type="button"
      aria-label="Dark mode switcher"
      class="flex items-center justify-center text-neutral-900 hover:text-primary-600 dark:text-neutral-200 dark:hover:text-primary-400">
      <div class="dark:hidden">
        <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M32 256c0-123.8 100.3-224 223.8-224c11.36 0 29.7 1.668 40.9 3.746c9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3c9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480C132.1 480 32 379.6 32 256z"/></svg>
</span>
      </div>
      <div class="hidden dark:block">
        <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M256 159.1c-53.02 0-95.1 42.98-95.1 95.1S202.1 351.1 256 351.1s95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347L446.1 255.1l63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7l-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89L164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6L12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256l-63.15 91.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7l19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109l109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69 0-127.1-57.31-127.1-127.1c0-70.69 57.31-127.1 127.1-127.1s127.1 57.3 127.1 127.1C383.1 326.7 326.7 383.1 256 383.1z"/></svg>
</span>
      </div>
    </button>
  

  
    <input type="checkbox" id="mobile-menu-toggle" autocomplete="off" class="hidden peer">
    <label for="mobile-menu-toggle" class="flex items-center justify-center cursor-pointer bf-icon-color-hover">
      <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M0 96C0 78.33 14.33 64 32 64H416C433.7 64 448 78.33 448 96C448 113.7 433.7 128 416 128H32C14.33 128 0 113.7 0 96zM0 256C0 238.3 14.33 224 32 224H416C433.7 224 448 238.3 448 256C448 273.7 433.7 288 416 288H32C14.33 288 0 273.7 0 256zM416 448H32C14.33 448 0 433.7 0 416C0 398.3 14.33 384 32 384H416C433.7 384 448 398.3 448 416C448 433.7 433.7 448 416 448z"/></svg>
</span>
    </label>

    <div
      role="dialog"
      aria-modal="true"
      style="scrollbar-gutter: stable;"
      class="fixed inset-0 z-50 invisible overflow-y-auto px-6 py-20 opacity-0 transition-[opacity,visibility] duration-300 peer-checked:visible peer-checked:opacity-100 bg-neutral-50/97 dark:bg-neutral-900/99
      bf-scrollbar">
      <label
        for="mobile-menu-toggle"
        class="fixed end-8 top-5 flex items-center justify-center z-50 h-12 w-12 cursor-pointer select-none rounded-full bf-icon-color-hover border bf-border-color bf-border-color-hover bg-neutral-50 dark:bg-neutral-900">
        <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>
</span>
      </label>
      <nav class="mx-auto max-w-md space-y-6">
        
  
    
    <div class="px-2">
      <a
        href="/posts/"
        aria-label="Blog"
        
        class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200">
        
        <span title="Posts" class="text-2xl font-bold tracking-tight">
          Blog
        </span>
        
      </a>

      
    </div>
  
    
    <div class="px-2">
      <a
        href="/about/"
        aria-label="About"
        
        class="flex items-center gap-4 group bf-icon-color-hover text-neutral-700 dark:text-neutral-200">
        
        <span title="About" class="text-2xl font-bold tracking-tight">
          About
        </span>
        
      </a>

      
    </div>
  

        
  

        
  

      </nav>
    </div>
  
</div>







    </div>
  </div>
</div>





    
    <div class="relative flex flex-col grow">
      <main id="main-content" class="grow">
        
  
  <article>
    
    
      
      
      
      
        







  
  
    
  
    
  
    
  
    
  






  
    
    
      
      
    
  





    <div id="hero" class="h-[150px] md:h-[200px]"></div>
  
  <div class="fixed inset-x-0 top-0 h-[800px] single_hero_background nozoom">
    
    
    
    <img
      id="background-image"
      src="/posts/observability-quick-start/feature_hu_e953d34820892d35.jpg"
      role="presentation"
      loading="eager"
      decoding="async"
      fetchpriority="high"
      class="absolute inset-0 w-full h-full object-cover"
      >
    <div
      class="absolute inset-0 bg-gradient-to-t from-neutral dark:from-neutral-800 to-transparent mix-blend-normal"></div>
    <div
      class="absolute inset-0 opacity-60 bg-gradient-to-t from-neutral dark:from-neutral-800 to-neutral-100 dark:to-neutral-800 mix-blend-normal"></div>
  </div>

  
    <div
      id="background-blur"
      class="fixed opacity-0 inset-x-0 top-0 h-full single_hero_background nozoom backdrop-blur-xl bg-neutral-100/75 dark:bg-neutral-800/60"></div>
    
    
    <script
      type="text/javascript"
      src="/js/background-blur.min.605b3b942818f0ab5a717ae446135ec46b8ee5a2ad12ae56fb90dc2a76ce30c388f9fec8bcc18db15bd47e3fa8a09d779fa12aa9c184cf614a315bc72c6c163d.js"
      integrity="sha512-YFs7lCgY8KtacXrkRhNexGuO5aKtEq5W&#43;5DcKnbOMMOI&#43;f7IvMGNsVvUfj&#43;ooJ13n6EqqcGEz2FKMVvHLGwWPQ=="
      data-blur-id="background-blur"
      data-image-id="background-image"
      data-image-url="/posts/observability-quick-start/feature_hu_e953d34820892d35.jpg"></script>
  
      
    

    
    <header id="single_header" class="mt-5 max-w-prose">
      
      <h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
        Performance Tuning Quick Start: Metrics, Profiling & Beyond
      </h1>
      <div class="mt-1 mb-6 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
        





  
  



  

  
  
  
    
  

  

  
    
  

  

  
    
  

  
    
  

  

  

  

  

  


  <div class="flex flex-row flex-wrap items-center">
    
    
      <time datetime="2025-04-10T00:00:00&#43;00:00">10 April 2025</time><span class="px-2 text-primary-500">&middot;</span><span>3579 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">17 mins</span>
    

    
    
  </div>

  

  
  

  
  



      </div>
      
        
  
  
  
  
  
  

  

  
    
    
<div class="flex author">
  
    
    
      
    
    
      
      
      
        
        
        
      
      <img
        class="!mt-0 !mb-0 h-24 w-24 rounded-full me-4"
        width="96"
        height="96"
        alt="Paweł Obrępalski"
        src="/img/avatar_hu_df9c2dec9ac346b6.png"
        data-zoom-src="/img/avatar_hu_7a16b7cbae0adbea.png">
    
  
  <div class="place-self-center">
    
      <div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">
        Author
      </div>
      <div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">
        Paweł Obrępalski
      </div>
    
    
      <div class="text-sm text-neutral-700 dark:text-neutral-400">Staff Engineer @ShareChat AI</div>
    
    <div class="text-2xl sm:text-lg">
  <div class="flex flex-wrap text-neutral-400 dark:text-neutral-500">
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://linkedin.com/in/obrepalski"
          target="_blank"
          aria-label="Linkedin"
          title="Linkedin"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
</span></span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="https://github.com/obrep"
          target="_blank"
          aria-label="Github"
          title="Github"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></span></a
        >
      
    
      
        <a
          class="px-1 hover:text-primary-700 dark:hover:text-primary-400"
          href="mailto:pawel@obrepalski.com"
          target="_blank"
          aria-label="Email"
          title="Email"
          rel="me noopener noreferrer"
          ><span class="inline-block align-text-bottom"><span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1c-27.64 140.9 68.65 266.2 199.1 285.1c19.01 2.888 36.17-12.26 36.17-31.49l.0001-.6631c0-15.74-11.44-28.88-26.84-31.24c-84.35-12.98-149.2-86.13-149.2-174.2c0-102.9 88.61-185.5 193.4-175.4c91.54 8.869 158.6 91.25 158.6 183.2l0 16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98 .0036c-7.299 0-13.2 4.992-15.12 11.68c-24.85-12.15-54.24-16.38-86.06-5.106c-38.75 13.73-68.12 48.91-73.72 89.64c-9.483 69.01 43.81 128 110.9 128c26.44 0 50.43-9.544 69.59-24.88c24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3C495.1 107.1 361.2-9.332 207.8 20.73zM239.1 304.3c-26.47 0-48-21.56-48-48.05s21.53-48.05 48-48.05s48 21.56 48 48.05S266.5 304.3 239.1 304.3z"/></svg>
</span></span></a
        >
      
    
  </div>

</div>
  </div>
</div>

  

  

  
    <div class="mb-5"></div>
  

      
    </header>

    
    <section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row">
      
      
      
      
      
        <div class="order-first lg:ms-auto px-0 lg:order-last lg:ps-8 lg:max-w-2xs">
          <div class="toc ps-5 print:hidden lg:sticky lg:top-10">
            <details
  open
  id="TOCView"
  class="toc-right mt-0 overflow-y-auto overscroll-contain bf-scrollbar rounded-lg -ms-5 ps-5 pe-2 hidden lg:block">
  <summary
    class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="min-w-[220px] py-2 border-dotted border-s-1 -ms-5 ps-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#metrics-your-services-dashboard-gauges">Metrics: Your Service&rsquo;s Dashboard Gauges</a>
      <ul>
        <li><a href="#adding-more-detailed-metrics-with-prometheus">Adding More Detailed Metrics with Prometheus</a></li>
      </ul>
    </li>
    <li><a href="#profiling-finding-the-needles-in-the-haystack">Profiling: Finding the Needles in the Haystack</a>
      <ul>
        <li><a href="#profiling-fundamentals">Profiling Fundamentals</a></li>
        <li><a href="#local-profiling-with-pprof">Local Profiling with pprof</a></li>
        <li><a href="#understanding-flame-graphs">Understanding Flame Graphs</a></li>
        <li><a href="#benchmarking-specific-functions-with-go-test">Benchmarking Specific Functions with <code>go test</code></a></li>
        <li><a href="#continuous-profiling-performance-insights-from-production">Continuous Profiling: Performance Insights from Production</a>
          <ul>
            <li><a href="#google-cloud-profiler-example">Google Cloud Profiler Example</a></li>
            <li><a href="#other-profiling-solutions">Other Profiling Solutions</a></li>
          </ul>
        </li>
        <li><a href="#profile-guided-optimization-pgo-letting-profiles-drive-compilation">Profile-Guided Optimization (PGO): Letting Profiles Drive Compilation</a>
          <ul>
            <li><a href="#getting-started-with-pgo">Getting Started with PGO</a></li>
            <li><a href="#benefits-and-considerations">Benefits and Considerations</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#a-brief-word-on-tracing">A Brief Word on Tracing</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
    <li><a href="#further-reading">Further Reading</a></li>
  </ul>
</nav>
  </div>
</details>
<details class="toc-inside mt-0 overflow-hidden rounded-lg -ms-5 ps-5 lg:hidden">
  <summary
    class="py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 -ms-5 ps-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">
    Table of Contents
  </summary>
  <div
    class="py-2 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#metrics-your-services-dashboard-gauges">Metrics: Your Service&rsquo;s Dashboard Gauges</a>
      <ul>
        <li><a href="#adding-more-detailed-metrics-with-prometheus">Adding More Detailed Metrics with Prometheus</a></li>
      </ul>
    </li>
    <li><a href="#profiling-finding-the-needles-in-the-haystack">Profiling: Finding the Needles in the Haystack</a>
      <ul>
        <li><a href="#profiling-fundamentals">Profiling Fundamentals</a></li>
        <li><a href="#local-profiling-with-pprof">Local Profiling with pprof</a></li>
        <li><a href="#understanding-flame-graphs">Understanding Flame Graphs</a></li>
        <li><a href="#benchmarking-specific-functions-with-go-test">Benchmarking Specific Functions with <code>go test</code></a></li>
        <li><a href="#continuous-profiling-performance-insights-from-production">Continuous Profiling: Performance Insights from Production</a>
          <ul>
            <li><a href="#google-cloud-profiler-example">Google Cloud Profiler Example</a></li>
            <li><a href="#other-profiling-solutions">Other Profiling Solutions</a></li>
          </ul>
        </li>
        <li><a href="#profile-guided-optimization-pgo-letting-profiles-drive-compilation">Profile-Guided Optimization (PGO): Letting Profiles Drive Compilation</a>
          <ul>
            <li><a href="#getting-started-with-pgo">Getting Started with PGO</a></li>
            <li><a href="#benefits-and-considerations">Benefits and Considerations</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#a-brief-word-on-tracing">A Brief Word on Tracing</a></li>
    <li><a href="#conclusion">Conclusion</a></li>
    <li><a href="#further-reading">Further Reading</a></li>
  </ul>
</nav>
  </div>
</details>


<script>
  (function () {
    'use strict'

    const SCROLL_OFFSET_RATIO = 0.33
    const TOC_SELECTOR = '#TableOfContents'
    const ANCHOR_SELECTOR = '.anchor'
    const TOC_LINK_SELECTOR = 'a[href^="#"]'
    const NESTED_LIST_SELECTOR = 'li ul'
    const ACTIVE_CLASS = 'active'
    let isJumpingToAnchor = false

    function getActiveAnchorId(anchors, offsetRatio) {
      const threshold = window.scrollY + window.innerHeight * offsetRatio
      const tocLinks = [...document.querySelectorAll('#TableOfContents a[href^="#"]')]
      const tocIds = new Set(tocLinks.map(link => link.getAttribute('href').substring(1)))

      if (isJumpingToAnchor) {
        for (let i = 0; i < anchors.length; i++) {
          const anchor = anchors[i]
          if (!tocIds.has(anchor.id)) continue
          const top = anchor.getBoundingClientRect().top + window.scrollY
          if (Math.abs(window.scrollY - top) < 100) {
            return anchor.id
          }
        }
      }

      for (let i = anchors.length - 1; i >= 0; i--) {
        const top = anchors[i].getBoundingClientRect().top + window.scrollY
        if (top <= threshold && tocIds.has(anchors[i].id)) {
          return anchors[i].id
        }
      }
      return anchors.find(anchor => tocIds.has(anchor.id))?.id || ''
    }

    function updateTOC({ toc, anchors, links, scrollOffset, collapseInactive }) {
      const activeId = getActiveAnchorId(anchors, scrollOffset)
      if (!activeId) return

      links.forEach(link => {
        const isActive = link.getAttribute('href') === `#${activeId}`
        link.classList.toggle(ACTIVE_CLASS, isActive)

        if (collapseInactive) {
          const ul = link.closest('li')?.querySelector('ul')
          if (ul) ul.style.display = isActive ? '' : 'none'
        }
      })

      if (collapseInactive) {
        const activeLink = toc.querySelector(`a[href="#${CSS.escape(activeId)}"]`)
        let el = activeLink
        while (el && el !== toc) {
          if (el.tagName === 'UL') el.style.display = ''
          if (el.tagName === 'LI') el.querySelector('ul')?.style.setProperty('display', '')
          el = el.parentElement
        }
      }
    }

    function initTOC() {
      const toc = document.querySelector(TOC_SELECTOR)
      if (!toc) return

      const collapseInactive = false
      const anchors = [...document.querySelectorAll(ANCHOR_SELECTOR)]
      const links = [...toc.querySelectorAll(TOC_LINK_SELECTOR)]

      if (collapseInactive) {
        toc.querySelectorAll(NESTED_LIST_SELECTOR).forEach(ul => ul.style.display = 'none')
      }

      links.forEach(link => {
        link.addEventListener('click', () => {
          isJumpingToAnchor = true
        })
      })

      const config = {
        toc,
        anchors,
        links,
        scrollOffset: SCROLL_OFFSET_RATIO,
        collapseInactive
      }

      window.addEventListener('scroll', () => updateTOC(config), { passive: true })
      window.addEventListener('hashchange', () => updateTOC(config), { passive: true })

      updateTOC(config)
    }

    document.readyState === 'loading'
      ? document.addEventListener('DOMContentLoaded', initTOC)
      : initTOC()
  })()
</script>


          </div>
        </div>
      


      <div class="min-w-0 min-h-0 max-w-fit">
        
  <details
    class="mt-2 mb-5 overflow-hidden rounded-lg ms-0 ps-5"
    >
    
  <summary
    class="py-1 text-lg font-semibold cursor-pointer bg-primary-200 text-neutral-800 -ms-5 ps-5 dark:bg-primary-800 dark:text-neutral-100">
    Optimising Cloud Services At Scale -
    This article is part of a series.
  </summary>
  
  
    
      <div
        class="py-1 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600">
        <a href="/posts/why-care-about-cost/">
          Part 1:
          Why Care About Cost as Software Engineer?
        </a>
      </div>
    
  
    
      <div
        class="py-1 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600">
        <a href="/posts/observability-and-guardrails/">
          Part 2:
          Cost Observability and Guardrails
        </a>
      </div>
    
  
    
      <div
        class="py-1 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600">
        Part 3:
        This Article
      </div>
    
  


  </details>


        <div class="article-content max-w-prose mb-20">
          <p>When working with microservices at scale, performance optimization becomes crucial for maintaining both system reliability and cost efficiency. Getting visibility into how your Go services behave under load is the first step towards making them faster and more efficient. This post will guide you through setting up essential observability tools: metrics and profiling. While the examples will be specific to Go, the concepts apply to other languages as well.</p>
<blockquote><p>&#x1f4a1; If you want to follow along, you will need to have Go installed: <a href="https://go.dev/doc/install"  target="_blank" rel="noreferrer">https://go.dev/doc/install</a>.</p>
</blockquote>
  



<div
  
    class="flex px-4 py-3 rounded-md shadow bg-primary-100 dark:bg-primary-900"
  
  >
  <span
    
      class="text-primary-400 pe-3 flex items-center"
    
    >
    <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M506.3 417l-213.3-364c-16.33-28-57.54-28-73.98 0l-213.2 364C-10.59 444.9 9.849 480 42.74 480h426.6C502.1 480 522.6 445 506.3 417zM232 168c0-13.25 10.75-24 24-24S280 154.8 280 168v128c0 13.25-10.75 24-23.1 24S232 309.3 232 296V168zM256 416c-17.36 0-31.44-14.08-31.44-31.44c0-17.36 14.07-31.44 31.44-31.44s31.44 14.08 31.44 31.44C287.4 401.9 273.4 416 256 416z"/></svg>
</span>
  </span>

  <span
    
      class="dark:text-neutral-300"
    
    >You can find all code examples in this site&rsquo;s <a href="https://github.com/obrep/obrepalski-com/tree/master/examples"  target="_blank" rel="noreferrer">repository</a>.</span>
</div>


<h1 class="relative group">Metrics: Your Service&rsquo;s Dashboard Gauges
    <div id="metrics-your-services-dashboard-gauges" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#metrics-your-services-dashboard-gauges" aria-label="Anchor">#</a>
    </span>
    
</h1>
<p>Think of metrics as the dashboard gauges for your application. They provide quantifiable measurements of your service&rsquo;s health and performance over time, like request rates, error counts, latency distributions, and resource utilization (CPU, memory). Starting with metrics gives you a high-level overview, helps identify trends, and allows you to set up alerts for abnormal behavior.</p>
<p>Runtime metrics can be easily added using <a href="https://prometheus.io/docs/introduction/overview/"  target="_blank" rel="noreferrer">Prometheus</a>, a popular open-source monitoring and alerting toolkit. You can install the Go client library by running:</p>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>go get github.com/prometheus/client_golang</span></span></code></pre></div></div>
<p>After that, adding a basic set of Go runtime metrics (like garbage collection stats, goroutine counts, memory usage) is as simple as exposing an HTTP endpoint using the default <code>promhttp.Handler</code>:</p>








































































































































































































































































































<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-Go" data-lang="Go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;log&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;math/rand&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;net/http&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;time&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// Import pprof package for side effects: registers HTTP handlers.</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// We use the blank identifier _ because we only need the side effects (handler registration)</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// from its init() function, not any functions directly from the package.</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">_</span> <span style="color:#e6db74">&#34;net/http/pprof&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// Start the pprof HTTP server on a separate port and goroutine.</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// Running it in a separate goroutine ensures it doesn&#39;t block the main application logic.</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// Using a different port (e.g., 6060) is common practice to avoid interfering</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// with the main application&#39;s port (e.g., 8080).</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">go</span> <span style="color:#66d9ef">func</span>() {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Starting pprof server on localhost:6060&#34;</span>)
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">ListenAndServe</span>(<span style="color:#e6db74">&#34;localhost:6060&#34;</span>, <span style="color:#66d9ef">nil</span>))
</span></span><span style="display:flex;"><span>	}()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// Your main service logic would go here...</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// For demonstration, we&#39;ll randomly pick a number every 100ms</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Main application running...&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">rand</span>.<span style="color:#a6e22e">Intn</span>(<span style="color:#ae81ff">100</span>))
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Sleep</span>(<span style="color:#ae81ff">100</span> <span style="color:#f92672">*</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Millisecond</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>


<p>You can run this example with <code>go run .</code>. Metrics will now be available at <code>localhost:8080/metrics</code>.</p>
<blockquote><p>&#x1f4a1; <strong>Tip:</strong> In a real setup, you wouldn&rsquo;t typically access this endpoint directly in your browser. Instead, a Prometheus server would <a href="https://prometheus.io/docs/introduction/overview/#architecture"  target="_blank" rel="noreferrer">periodically scrape this endpoint</a>, storing the time-series data. You&rsquo;d then use tools like Grafana to query Prometheus and visualize the metrics. However, checking the <code>/metrics</code> endpoint manually is a great way for quickly verifying that your application is exposing metrics as expected, especially when adding custom ones.</p>
</blockquote>
<h2 class="relative group">Adding More Detailed Metrics with Prometheus
    <div id="adding-more-detailed-metrics-with-prometheus" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#adding-more-detailed-metrics-with-prometheus" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>The default handler is a good start, but often you&rsquo;ll want more detailed information about your application code or the Go process itself. The <code>collectors</code> package provides fine-grained metrics about the Go runtime and the process.</p>
<p>Here’s how you can create a custom registry and add these specific collectors:</p>








































































































































































































































































<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-Go" data-lang="Go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;log&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;net/http&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;github.com/prometheus/client_golang/prometheus&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;github.com/prometheus/client_golang/prometheus/collectors&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;github.com/prometheus/client_golang/prometheus/promhttp&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// Create a non-global registry.</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">reg</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">prometheus</span>.<span style="color:#a6e22e">NewRegistry</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// Add collectors for Go runtime stats and process stats.</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// TODO: check if this can be done more easily</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">reg</span>.<span style="color:#a6e22e">MustRegister</span>(
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">collectors</span>.<span style="color:#a6e22e">NewGoCollector</span>(),
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">collectors</span>.<span style="color:#a6e22e">NewProcessCollector</span>(<span style="color:#a6e22e">collectors</span>.<span style="color:#a6e22e">ProcessCollectorOpts</span>{}),
</span></span><span style="display:flex;"><span>	)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// Expose metrics using the custom registry.</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Handle</span>(<span style="color:#e6db74">&#34;/metrics&#34;</span>, <span style="color:#a6e22e">promhttp</span>.<span style="color:#a6e22e">HandlerFor</span>(<span style="color:#a6e22e">reg</span>, <span style="color:#a6e22e">promhttp</span>.<span style="color:#a6e22e">HandlerOpts</span>{}))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Starting server on :8080&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatal</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">ListenAndServe</span>(<span style="color:#e6db74">&#34;:8080&#34;</span>, <span style="color:#66d9ef">nil</span>))
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>


<p>This setup gives you deeper insights into Garbage Collector (GC) performance, memory allocation details, and process-level stats like CPU and memory usage, file descriptors, etc. Beyond these, you can <a href="https://prometheus.io/docs/guides/go-application/#adding-your-own-metrics"  target="_blank" rel="noreferrer">easily add your own custom application-specific metrics</a> (e.g., number of cache hits, specific business operation counters).</p>
<p>For a complete example of runtime metrics collection, see the <a href="https://github.com/prometheus/client_golang/blob/main/examples/gocollector/main.go"  target="_blank" rel="noreferrer">prometheus/client_golang example</a>.</p>

<h1 class="relative group">Profiling: Finding the Needles in the Haystack
    <div id="profiling-finding-the-needles-in-the-haystack" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#profiling-finding-the-needles-in-the-haystack" aria-label="Anchor">#</a>
    </span>
    
</h1>
<p>While metrics give us a great overview (the &ldquo;what&rdquo;), they often don&rsquo;t tell us the &ldquo;why.&rdquo; If your latency is high or CPU usage is spiking, metrics alone might not pinpoint the exact lines of code responsible. Their granularity is usually too low for deep optimization. This is where profiling comes in – it helps us look inside the application&rsquo;s execution to see exactly where time is spent or memory is allocated, revealing the bottlenecks.</p>

<h2 class="relative group">Profiling Fundamentals
    <div id="profiling-fundamentals" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#profiling-fundamentals" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>Profiling captures detailed runtime behavior. For performance optimization, two types are most commonly used:</p>
<ul>
<li><strong>CPU Profiling:</strong> Captures stack traces over time to show where your program is spending its CPU cycles. Essential for identifying &ldquo;hot paths&rdquo; – functions that consume significant processing time.</li>
<li><strong>Memory Profiling:</strong> Takes snapshots of the heap to show where memory is being allocated. Helps understand object lifetimes, identify memory leaks, and analyze garbage collection pressure. Understanding allocation patterns is key to performance in Go.</li>
</ul>
<p>Go also provides specialized profiles (goroutine, block, mutex), which are useful for diagnosing concurrency issues but are generally used less frequently than CPU and memory profiling for general optimization.</p>

<h2 class="relative group">Local Profiling with pprof
    <div id="local-profiling-with-pprof" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#local-profiling-with-pprof" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>Go&rsquo;s built-in <a href="https://pkg.go.dev/runtime/pprof"  target="_blank" rel="noreferrer"><code>pprof</code></a> package makes profiling straightforward. It can collect profiling data and expose it over an HTTP endpoint for analysis.</p>
<p>Local profiling with <code>pprof</code> is invaluable during the development cycle and for investigating specific, reproducible performance issues. It&rsquo;s the go-to tool when you need immediate feedback on the performance impact of code changes or when analyzing behavior that might not be present or easy to isolate in a production environment captured by continuous profiling. Use cases where local profiling shines, and continuous profiling might be less helpful or slower, include: debugging performance regressions introduced in a specific feature branch before merging, interactively testing different optimization ideas for a known bottleneck, or analyzing issues that only manifest in specific development or testing environments.</p>
<blockquote><p>&#x1f4a1; <strong>Tip:</strong> Enabling the <code>pprof</code> endpoint in production-like environments (perhaps on a specific instance, canary, or behind authentication) can be invaluable for quick troubleshooting of live issues.</p>
</blockquote><p>The easiest way to enable this is via a side effect import of <code>net/http/pprof</code>.</p>
































































































































































































































































<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-Go" data-lang="Go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;log&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;net/http&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// Import pprof package for side effects: registers HTTP handlers.</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// We use the blank identifier _ because we only need the side effects (handler registration)</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// from its init() function, not any functions directly from the package.</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">_</span> <span style="color:#e6db74">&#34;net/http/pprof&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// Start the pprof HTTP server on a separate port and goroutine.</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// Running it in a separate goroutine ensures it doesn&#39;t block the main application logic.</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// Using a different port (e.g., 6060) is common practice to avoid interfering</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// with the main application&#39;s port (e.g., 8080).</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">go</span> <span style="color:#66d9ef">func</span>() {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Starting pprof server on localhost:6060&#34;</span>)
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">ListenAndServe</span>(<span style="color:#e6db74">&#34;localhost:6060&#34;</span>, <span style="color:#66d9ef">nil</span>))
</span></span><span style="display:flex;"><span>	}()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// Your main service logic would go here...</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// For demonstration, we&#39;ll just block forever.</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Main application running...&#34;</span>)
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">select</span> {}
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>


<p>This import registers several endpoints under <code>/debug/pprof/</code> on port <code>6060</code>:</p>
<ul>
<li><code>/debug/pprof/profile</code>: CPU profile (collects data for a duration, typically 30s by default).</li>
<li><code>/debug/pprof/heap</code>: Memory profile (snapshot of heap allocations).</li>
<li><code>/debug/pprof/goroutine</code>: Goroutine profile (stack traces of all current goroutines).</li>
<li><code>/debug/pprof/block</code>: Block profile (stack traces leading to blocking sync primitives).</li>
<li><code>/debug/pprof/mutex</code>: Mutex profile (stack traces of contended mutex holders).</li>
</ul>
<p>Once your service is running, you can analyze these profiles using the <code>go tool pprof</code> command. The most convenient way is often using the <code>-http</code> flag, which fetches the profile data and launches an interactive web UI:</p>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Analyze CPU profile (will collect data for 30s)</span>
</span></span><span style="display:flex;"><span>go tool pprof -http<span style="color:#f92672">=</span>:9090 localhost:6060/debug/pprof/profile
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Analyze memory profile (instantaneous snapshot)</span>
</span></span><span style="display:flex;"><span>go tool pprof -http<span style="color:#f92672">=</span>:9090 localhost:6060/debug/pprof/heap</span></span></code></pre></div></div>
<p>Running these commands will fetch the profile data from your running application and open a web browser interface served on port <code>9090</code>, allowing you to explore the data visually.</p>
<blockquote><p>&#x1f4a1; <strong>Tip:</strong> If profiling reveals significant time spent in standard library functions (like marshalling/unmarshalling or compression), consider evaluating high-performance third-party alternatives (e.g., <a href="https://github.com/bytedance/sonic"  target="_blank" rel="noreferrer"><code>sonic</code></a> for JSON). Always benchmark to confirm improvements in your specific use case.</p>
</blockquote>
<h2 class="relative group">Understanding Flame Graphs
    <div id="understanding-flame-graphs" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#understanding-flame-graphs" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>One of the most powerful visualizations in the <code>pprof</code> web UI is the flame graph. Below is an interactive flame graph generated from a simple Go program designed to highlight CPU usage and allocation patterns. You can find the source code for this example in the <code>/examples/flamegraph</code> directory and play with full version <a href="https://flamegraph.com/share/daa01660-1434-11f0-86bc-aa320ab09ef2"  target="_blank" rel="noreferrer">here</a>.</p>
<iframe src="https://flamegraph.com/share/daa01660-1434-11f0-86bc-aa320ab09ef2/iframe?onlyDisplay=flamegraph&amp;showToolbar=true" width="100%" height="400"> </iframe>
<p>Flame graphs visualize hierarchical data (like call stacks) effectively. Key things to understand when reading any flame graph:</p>
<ul>
<li><strong>Y-axis:</strong> Represents the stack depth (function calls), with the root function (<code>main</code>) typically at the bottom and deeper calls stacked on top.</li>
<li><strong>X-axis:</strong> Spans the sample population. The <em>width</em> of a function block indicates the proportion of time (for CPU profiles) or allocated memory (for heap profiles) spent <em>directly</em> in that function or functions it called. Wider blocks mean more time/memory consumption relative to the total profile duration or allocation size.</li>
<li><strong>Reading:</strong> Look for wide plateaus, especially near the top of the graph. These represent functions where significant time is being spent directly. Clicking on a block zooms in on that part of the hierarchy, filtering the view to show only that function and its descendants.</li>
</ul>
<p>The <code>pprof</code> UI also offers other views like Top (tabular list of most expensive functions), Graph (call graph visualization - requires Graphviz), and Source (line-by-line annotation).</p>
<blockquote><p>&#x26a0;&#xfe0f; You need <code>graphviz</code> installed locally for some visualization options (like the &lsquo;Graph&rsquo; view) within the web UI. You can install it running: <code>brew install graphviz</code> or check <a href="https://graphviz.org/download/"  target="_blank" rel="noreferrer">https://graphviz.org/download/</a></p>
</blockquote>
<h2 class="relative group">Benchmarking Specific Functions with <code>go test</code>
    <div id="benchmarking-specific-functions-with-go-test" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#benchmarking-specific-functions-with-go-test" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>While profiling helps you find bottlenecks in your running application, sometimes you want to measure the performance of a <em>specific</em> piece of code in isolation or compare different implementations of a function. Go has excellent built-in support for this via its <code>testing</code> package, which includes benchmarking capabilities.</p>
<p>Benchmarks live in <code>_test.go</code> files alongside your regular tests. They look similar to tests but follow the <code>BenchmarkXxx</code> naming convention and accept a <code>*testing.B</code> parameter.</p>
<p>Here&rsquo;s a simple example: Suppose we have a function <code>ConcatenateStrings</code>:</p>








































































































































































<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-Go" data-lang="Go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> <span style="color:#e6db74">&#34;strings&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">ConcatenateStrings</span>(<span style="color:#a6e22e">parts</span> []<span style="color:#66d9ef">string</span>) <span style="color:#66d9ef">string</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">strings</span>.<span style="color:#a6e22e">Join</span>(<span style="color:#a6e22e">parts</span>, <span style="color:#e6db74">&#34;&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Slower implementation for comparison:</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">ConcatenateStringsSlowly</span>(<span style="color:#a6e22e">parts</span> []<span style="color:#66d9ef">string</span>) <span style="color:#66d9ef">string</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">var</span> <span style="color:#a6e22e">result</span> <span style="color:#66d9ef">string</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">s</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">parts</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">result</span> <span style="color:#f92672">+=</span> <span style="color:#a6e22e">s</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">result</span>
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>


<p>We can write benchmarks for these in <code>concat_test.go</code>:</p>
































































































































































































<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-Go" data-lang="Go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> <span style="color:#e6db74">&#34;testing&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">input</span> = []<span style="color:#66d9ef">string</span>{<span style="color:#e6db74">&#34;a&#34;</span>, <span style="color:#e6db74">&#34;b&#34;</span>, <span style="color:#e6db74">&#34;c&#34;</span>, <span style="color:#e6db74">&#34;d&#34;</span>, <span style="color:#e6db74">&#34;e&#34;</span>, <span style="color:#e6db74">&#34;f&#34;</span>, <span style="color:#e6db74">&#34;g&#34;</span>, <span style="color:#e6db74">&#34;h&#34;</span>, <span style="color:#e6db74">&#34;i&#34;</span>, <span style="color:#e6db74">&#34;j&#34;</span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">BenchmarkConcatenateStrings</span>(<span style="color:#a6e22e">b</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">testing</span>.<span style="color:#a6e22e">B</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// The loop runs b.N times. b.N is adjusted by the testing framework</span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// until the benchmark runs for a stable, measurable duration.</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> &lt; <span style="color:#a6e22e">b</span>.<span style="color:#a6e22e">N</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">ConcatenateStrings</span>(<span style="color:#a6e22e">input</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">BenchmarkConcatenateStringsSlowly</span>(<span style="color:#a6e22e">b</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">testing</span>.<span style="color:#a6e22e">B</span>) {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">for</span> <span style="color:#a6e22e">i</span> <span style="color:#f92672">:=</span> <span style="color:#ae81ff">0</span>; <span style="color:#a6e22e">i</span> &lt; <span style="color:#a6e22e">b</span>.<span style="color:#a6e22e">N</span>; <span style="color:#a6e22e">i</span><span style="color:#f92672">++</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">ConcatenateStringsSlowly</span>(<span style="color:#a6e22e">input</span>)
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>


<p>You run benchmarks using the <code>go test</code> command with the <code>-bench</code> flag. The <code>.</code> argument tells it to benchmark functions in the current folder:</p>
<div class="highlight-wrapper"><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span> <span style="color:#a6e22e">Run</span> <span style="color:#a6e22e">all</span> <span style="color:#a6e22e">benchmarks</span> <span style="color:#a6e22e">in</span> <span style="color:#a6e22e">the</span> <span style="color:#a6e22e">current</span> <span style="color:#a6e22e">folder</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">go</span> <span style="color:#a6e22e">test</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">bench</span>=.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">#</span> <span style="color:#a6e22e">Add</span> <span style="color:#a6e22e">memory</span> <span style="color:#a6e22e">allocation</span> <span style="color:#a6e22e">stats</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">go</span> <span style="color:#a6e22e">test</span> <span style="color:#f92672">-</span><span style="color:#a6e22e">bench</span>=. <span style="color:#f92672">-</span><span style="color:#a6e22e">benchmem</span></span></span></code></pre></div></div>
<p>The results clearly show that <code>ConcatenateStrings</code> is not only ~2.5x faster (186 vs 73 ns) but also results in less memory allocations (1 vs 9):</p>
<p><figure><img
    class="my-0 rounded-md"
    loading="lazy"
    decoding="async"
    fetchpriority="auto"
    alt="Results of running go test -bench=. -benchmem"
    width="1565"
    height="250"
    src="/benchmark_result_hu_1a930662bc2ac897.jpg"
    srcset="/benchmark_result_hu_1a930662bc2ac897.jpg 800w, /benchmark_result_hu_c0998fa7ed05f4c7.jpg 1280w"
    sizes="(min-width: 768px) 50vw, 65vw"
    data-zoom-src="/benchmark_result.jpg"></figure>
</p>
<p>Benchmarking is invaluable for:</p>
<ul>
<li>Validating the performance impact of code changes before merging.</li>
<li>Comparing performance of different algorithms/libraries.</li>
<li>Micro-optimizing critical functions identified through profiling.</li>
</ul>
<p>Beyond timing and allocations, Go also offers execution tracing specifically during tests via <code>go test -trace=trace.out</code>. This generates a trace file that can be visualized with go tool trace trace.out. The visualization provides a detailed timeline showing goroutine execution, points where goroutines block (e.g., on syscalls, channels, mutexes), and garbage collection events, which is invaluable for diagnosing concurrency issues or unexpected latency within a test run.</p>
<p>&#x1f4a1; Tip: You can generate CPU and memory profiles specifically for your benchmark execution using flags like <code>-cpuprofile cpu.prof</code> and <code>-memprofile mem.prof</code>. This lets you use <code>pprof</code> to analyze the performance characteristics of the exact code exercised by the benchmark.</p>
<p>For more details, see the official Go documentation on writing <a href="https://pkg.go.dev/testing#hdr-Benchmarks"  target="_blank" rel="noreferrer">benchmarks</a> and <a href="https://go.dev/blog/execution-traces-2024"  target="_blank" rel="noreferrer">tracing</a>.</p>

<h2 class="relative group">Continuous Profiling: Performance Insights from Production
    <div id="continuous-profiling-performance-insights-from-production" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#continuous-profiling-performance-insights-from-production" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>While local profiling is great for development and debugging specific issues, <strong>continuous profiling</strong> captures data from your live production environment over time. This provides invaluable insights into real-world performance, helps catch regressions early, and allows comparison across deployments.</p>
<p>Benefits:</p>
<ul>
<li>Understand performance under actual production load and traffic patterns.</li>
<li>Easily compare performance between versions (e.g., canary vs. stable).</li>
<li>Quickly identify performance regressions introduced by new code.</li>
<li>Low overhead; profiles are collected periodically across deployments.</li>
<li>Available on most major cloud providers and as third-party solutions.</li>
<li>Optimize Resource Utilization: Identify trends in CPU and memory usage under real load across different versions, helping pinpoint inefficiencies or regressions that impact infrastructure costs. Continuous profiling is extremely useful here as it shows actual resource consumption patterns over time, not just theoretical or benchmarked behavior.</li>
</ul>

<h3 class="relative group">Google Cloud Profiler Example
    <div id="google-cloud-profiler-example" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#google-cloud-profiler-example" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p>Cloud Profiler makes it easy to get started with continuous profiling on Google Cloud. It allows version-to-version comparisons, which is perfect for analyzing the impact of a new deployment.</p>
<blockquote><p>&#x26a0;&#xfe0f; Ensure the service account your application runs under has the <code>roles/cloudprofiler.agent</code> IAM role to submit profiles.</p>
</blockquote><p>Integrating the profiler is straightforward:








































































































































































































































































<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none;"><code class="language-Go" data-lang="Go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> (
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;log&#34;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;os&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#e6db74">&#34;cloud.google.com/go/profiler&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// Configuration for the profiler.</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">cfg</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">profiler</span>.<span style="color:#a6e22e">Config</span>{
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">Service</span>:        <span style="color:#e6db74">&#34;your-service-name&#34;</span>,      <span style="color:#75715e">// Replace with your service name</span>
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">ServiceVersion</span>: <span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Getenv</span>(<span style="color:#e6db74">&#34;APP_VERSION&#34;</span>), <span style="color:#75715e">// Use an env var for version (e.g., BUILD_ID, git SHA)</span>
</span></span><span style="display:flex;"><span>		<span style="color:#75715e">// ProjectID is optional if running on GCP infra (inferred)</span>
</span></span><span style="display:flex;"><span>		<span style="color:#75715e">// ProjectID: &#34;your-gcp-project-id&#34;,</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// Start the profiler. Errors are logged if it fails to start.</span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">profiler</span>.<span style="color:#a6e22e">Start</span>(<span style="color:#a6e22e">cfg</span>); <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatalf</span>(<span style="color:#e6db74">&#34;WARN: Failed to start profiler: %v&#34;</span>, <span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>		<span style="color:#75715e">// Usually, you wouldn&#39;t stop the app if the profiler fails,</span>
</span></span><span style="display:flex;"><span>		<span style="color:#75715e">// so we just log the error.</span>
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#75715e">// ... rest of your application startup and logic ...</span>
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Println</span>(<span style="color:#e6db74">&#34;Application started...&#34;</span>)
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div>

</p>
<blockquote><p>&#x1f4a1; <strong>Tip:</strong> Using an environment variable like <code>APP_VERSION</code> (populated from your CI/CD system with a build ID or git commit hash) is highly recommended. This allows Cloud Profiler (and other tools) to correlate performance data directly with specific code versions, making it easy to track regressions or improvements over time.</p>
</blockquote><p>For more details, refer to the <a href="https://cloud.google.com/profiler/docs/setting-up-go"  target="_blank" rel="noreferrer">Google Cloud Profiler Go setup documentation</a>.</p>

<h3 class="relative group">Other Profiling Solutions
    <div id="other-profiling-solutions" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#other-profiling-solutions" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p>Most major cloud providers offer profiling tools, though language support varies (e.g., <a href="https://aws.amazon.com/codeguru/"  target="_blank" rel="noreferrer">AWS CodeGuru</a> for Java/Python, <a href="https://azure.microsoft.com/en-us/products/monitor/"  target="_blank" rel="noreferrer">Azure Monitor</a> for .NET). There are also excellent third-party, language-agnostic observability platforms that include continuous profiling, such as <a href="https://docs.datadoghq.com/profiler/"  target="_blank" rel="noreferrer">Datadog</a>, <a href="https://newrelic.com/platform/application-monitoring"  target="_blank" rel="noreferrer">New Relic</a>, <a href="https://www.honeycomb.io/"  target="_blank" rel="noreferrer">Honeycomb</a>, and <a href="https://grafana.com/oss/pyroscope/"  target="_blank" rel="noreferrer">Grafana Pyroscope</a>.</p>

<h2 class="relative group">Profile-Guided Optimization (PGO): Letting Profiles Drive Compilation
    <div id="profile-guided-optimization-pgo-letting-profiles-drive-compilation" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#profile-guided-optimization-pgo-letting-profiles-drive-compilation" aria-label="Anchor">#</a>
    </span>
    
</h2>
<p>Continuous profiling gives us insights into production behavior. <strong>What if we could feed those insights back into the compiler?</strong> Since Go 1.21, the compiler includes built-in support for Profile-Guided Optimization (PGO), which is enabled by default. PGO uses CPU profiles gathered from real-world application runs to make more informed optimization decisions during the build process.</p>
<p>The core idea is simple: if the compiler knows which parts of your code are executed most frequently (the &ldquo;hot paths&rdquo; identified in a CPU profile), it can apply more aggressive optimizations to those specific areas. A primary example of such optimization is improved inlining – deciding more accurately when replacing a function call with the body of the called function will yield the best performance based on actual usage patterns.</p>

<h3 class="relative group">Getting Started with PGO
    <div id="getting-started-with-pgo" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#getting-started-with-pgo" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p>Leveraging PGO can be straightforward:</p>
<ol>
<li>Obtain a Profile: Collect a representative CPU profile (in the standard <code>pprof</code> format) from your application running under a realistic production or staging load. The continuous profiling tools mentioned earlier are excellent sources for this.</li>
<li>Place the Profile: Copy the collected profile file (e.g., <code>cpu.pprof</code>) into the root directory of your main package (where your main.go file typically resides) and rename it to default.pgo.</li>
<li>Build: Simply run go build. The Go compiler (1.21+) automatically detects default.pgo in the main package directory and uses it to guide optimizations.</li>
</ol>
<p>You can also explicitly specify a profile location using the <code>-pgo</code> flag during the build (<code>go build -pgo=/path/to/your/profile.pprof</code>) or disable PGO entirely (<code>go build -pgo=off</code>).</p>

<h3 class="relative group">Benefits and Considerations
    <div id="benefits-and-considerations" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#benefits-and-considerations" aria-label="Anchor">#</a>
    </span>
    
</h3>
<p>PGO offers the potential for performance improvements by fine-tuning the compiled code based on actual execution data. However, based on practical experience and the nature of PGO, keep these points in mind:</p>
<ul>
<li><strong>Performance Gains:</strong> While the Go team often reports gains in the 2-7% range for typical CPU-bound benchmarks, your results will vary based on your workload. Services that are heavily <strong>I/O-bound</strong> (spending most of their time waiting for network or disk) might see less significant gains compared to <strong>CPU-bound</strong> services where computation is the bottleneck.</li>
<li><strong>Increased Build Times:</strong> Enabling PGO often <strong>significantly increases build times</strong> (potentially by 5-10x or more in some cases). This happens because the profile information can influence how dependencies are compiled, often forcing them to be rebuilt. Implementing robust <strong>build caching</strong> in your CI/CD pipeline is highly recommended to mitigate this impact.</li>
<li><strong>Measure Impact:</strong> Always benchmark your application with and without PGO enabled to objectively measure the performance difference in your specific context. Compare the gains against the added build complexity.</li>
<li><strong>Evolving Feature:</strong> PGO is a relatively new addition to the Go toolchain and is expected to improve and offer more sophisticated optimizations in future Go releases.</li>
</ul>
<p>PGO represents a fascinating link between runtime observability and compile-time optimization, offering another lever to pull in the quest for better Go service performance, especially when combined with insights from continuous profiling.</p>
<blockquote><p>&#x1f517; For more detailed information, refer to the official Go documentation on <a href="https://go.dev/doc/pgo"  target="_blank" rel="noreferrer">Profile-Guided Optimization</a>.</p>
</blockquote>
<h1 class="relative group">A Brief Word on Tracing
    <div id="a-brief-word-on-tracing" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#a-brief-word-on-tracing" aria-label="Anchor">#</a>
    </span>
    
</h1>
<p>Metrics give you the overview (the &ldquo;what&rdquo;), and profiling gives you the deep dive into a single service&rsquo;s internals (the &ldquo;why&rdquo; for CPU/memory). But what about understanding the sequence and duration of operations <em>within</em> a request&rsquo;s lifecycle? If a specific API endpoint is slow, is it the database query, an external API call, or the internal processing logic that&rsquo;s taking the most time?</p>
<p>This is where <strong>Tracing</strong> comes in. At its core, tracing provides a detailed view of a request or operation&rsquo;s journey through your system by breaking it down into timed steps called <strong>spans</strong>. Even within a single service, tracing can be incredibly useful for pinpointing bottlenecks in complex workflows. For example, you could trace a single incoming request to see how much time was spent in authentication middleware, data fetching, data transformation, and response serialization.</p>
<p>Now, consider the microservices environment. If a user request is slow, and it involves calls chaining across <em>multiple</em> services, identifying the culprit becomes much harder using only metrics and profiles from individual services. This is the problem <strong>Distributed Tracing</strong> solves. It involves propagating context (like a unique trace ID) with requests as they move between services, allowing you to visualize the entire end-to-end journey, including timing for each service hop and the operations within those services.</p>
<p>Implementing tracing often involves instrumenting your code (manually or automatically) to create these <strong>spans</strong>. <a href="https://opentelemetry.io/"  target="_blank" rel="noreferrer">OpenTelemetry</a> is the emerging standard for observability data, including tracing.</p>
<p><strong>Auto-instrumentation Challenge in Go:</strong> Unlike runtime-interpreted languages like Java or Python, Go compiles directly to native machine code. This makes automatic instrumentation (where an agent modifies code at runtime to inject tracing logic) much harder. While OpenTelemetry provides libraries for <em>manual</em> instrumentation in Go, true auto-instrumentation often relies on techniques like:</p>
<ul>
<li>Compile-time code generation.</li>
<li>Using <strong>eBPF</strong> in the Linux kernel to observe application behavior (like system calls, network requests) without modifying the application code itself. eBPF-based auto-instrumentation for Go is an active area of development in the observability space.</li>
</ul>
<p>While powerful, setting up distributed tracing is often more involved than metrics or profiling. However, understanding its role completes the picture of modern observability. For many optimization tasks focused within a single service, metrics and profiling are the essential starting points.</p>

<h1 class="relative group">Conclusion
    <div id="conclusion" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#conclusion" aria-label="Anchor">#</a>
    </span>
    
</h1>
<p>Optimizing Go microservices effectively starts with visibility. This post focused on the foundational pillars for observing your <em>application&rsquo;s behavior</em>:</p>
<ol>
<li>Begin with <strong>metrics</strong> (using Prometheus) to get a high-level, quantitative view of your service&rsquo;s health, resource consumption, and request handling (latency, errors, rate). This allows you to monitor trends and set alerts.</li>
<li>When metrics indicate a problem (e.g., high latency, excessive CPU/memory usage) or you need to proactively optimize, dive deeper with <strong>profiling</strong> (using <code>pprof</code> locally or a continuous profiler like Google Cloud Profiler in production). This reveals exactly where CPU time is spent and memory is allocated <em>within your code</em>.</li>
<li>Leverage the collected CPU profiles further with <strong>Profile-Guided Optimization (PGO)</strong>, allowing the compiler to make more informed optimization decisions (like inlining) based on real-world execution data, potentially improving performance with no code changes.</li>
</ol>
<p>Armed with the metrics and profiling techniques discussed here, you can already take concrete actions to improve your service&rsquo;s performance and efficiency directly within your application code. For instance, you can:</p>
<ul>
<li><strong>Refactor CPU-intensive functions</strong> identified via CPU profiling.</li>
<li><strong>Optimize memory usage and eliminate leaks</strong> identified via heap profiles.</li>
<li><strong>Identify and potentially remove unnecessary work</strong> revealed in CPU profiles.</li>
<li><strong>Benefit from compiler optimizations</strong> targeted at your actual hot paths via PGO.</li>
<li><strong>Use latency distribution metrics</strong> (like histograms or summaries) to set meaningful Service Level Objectives (SLOs) and track improvements.</li>
<li><strong>Analyze process/runtime metrics</strong> to understand baseline resource usage and GC behavior before and after code changes.</li>
</ul>
<p>These tools primarily help you understand and optimize your <em>application code</em>. In the next post, we will shift focus and explore how tuning the Go <em>runtime</em> itself can provide further performance gains, building upon the application-level insights gained here.</p>

<h1 class="relative group">Further Reading
    <div id="further-reading" class="anchor"></div>
    
    <span
        class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100 select-none">
        <a class="text-primary-300 dark:text-neutral-700 !no-underline" href="#further-reading" aria-label="Anchor">#</a>
    </span>
    
</h1>
<ul>
<li><a href="https://prometheus.io/docs/introduction/overview/"  target="_blank" rel="noreferrer">Prometheus Documentation</a> - Learn more about Prometheus.</li>
<li><a href="https://go.dev/blog/pprof"  target="_blank" rel="noreferrer">Profiling Go Programs</a> - Official Go blog post on <code>pprof</code>.</li>
<li><a href="https://playground.flamegraph.com/playground"  target="_blank" rel="noreferrer">Go Flamegraph Playground</a> - Run simple Go programs and see how their flamegraphs in your browser</li>
<li><a href="https://www.cncf.io/blog/2022/05/31/what-is-continuous-profiling/"  target="_blank" rel="noreferrer">What is continuous profiling?</a> - CNCF article explaining the concept.</li>
<li><a href="https://go.dev/doc/pgo"  target="_blank" rel="noreferrer">Profile-guided optimization</a> - Official documentation.</li>
<li><a href="https://opentelemetry.io/docs/instrumentation/go/"  target="_blank" rel="noreferrer">OpenTelemetry Go Documentation</a> - For manual instrumentation and understanding tracing concepts in Go.</li>
</ul>

          
          
          
        </div>
        
        
  <details class="mt-2 mb-5 overflow-hidden rounded-lg ms-0 ps-5">
    
  <summary
    class="py-1 text-lg font-semibold cursor-pointer bg-primary-200 text-neutral-800 -ms-5 ps-5 dark:bg-primary-800 dark:text-neutral-100">
    Optimising Cloud Services At Scale -
    This article is part of a series.
  </summary>
  
  
    
      <div
        class="py-1 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600">
        <a href="/posts/why-care-about-cost/">
          Part 1:
          Why Care About Cost as Software Engineer?
        </a>
      </div>
    
  
    
      <div
        class="py-1 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600">
        <a href="/posts/observability-and-guardrails/">
          Part 2:
          Cost Observability and Guardrails
        </a>
      </div>
    
  
    
      <div
        class="py-1 border-dotted border-neutral-300 border-s-1 -ms-5 ps-5 dark:border-neutral-600">
        Part 3:
        This Article
      </div>
    
  


  </details>


        

        
  
  
    <h2 class="mt-8 text-2xl font-extrabold mb-10">Related</h2>
    <section class="w-full grid gap-4 sm:grid-cols-2 md:grid-cols-3">
      
        







  

  
  
    
    
      
    
      
    
      
    
  

  
  

  
  
    
      
      
        
      
    
  



<article
  class="article-link--related relative min-h-full min-w-full overflow-hidden rounded-lg border border-neutral-300 dark:border-neutral-600">
  
    <div class="flex-none relative overflow-hidden thumbnail_card_related">
      <img
        src="/posts/observability-and-guardrails/feature_hu_c5a32659a4f80338.jpg"
        role="presentation"
        loading="lazy"
        decoding="async"
        fetchpriority="low"
        class="not-prose absolute inset-0 w-full h-full object-cover">
    </div>
  
  
  <div class="p-4">
    <header>
      <a
        
          href="/posts/observability-and-guardrails/"
        
        class="not-prose before:absolute before:inset-0 decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 hover:underline hover:underline-offset-2">
        <h2>
          Cost Observability and Guardrails
          
        </h2>
      </a>
    </header>
    <div class="text-sm text-neutral-500 dark:text-neutral-400">
      







  

  
  
  
    
  

  

  
    
  

  

  
    
  

  
    
  

  

  

  

  

  


  <div class="flex flex-row flex-wrap items-center">
    
    
      <time datetime="2025-02-18T00:00:00&#43;00:00">18 February 2025</time><span class="px-2 text-primary-500">&middot;</span><span>1598 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">8 mins</span>
    

    
    
  </div>

  

  
  

  
  



    </div>
    
  </div>
  <div class="px-6 pt-4 pb-2"></div>
</article>

      
        







  

  
  
    
    
      
    
      
    
      
    
  

  
  

  
  
    
      
      
        
      
    
  



<article
  class="article-link--related relative min-h-full min-w-full overflow-hidden rounded-lg border border-neutral-300 dark:border-neutral-600">
  
    <div class="flex-none relative overflow-hidden thumbnail_card_related">
      <img
        src="/posts/why-care-about-cost/feature_hu_64fe0c6d782d1dd0.jpg"
        role="presentation"
        loading="lazy"
        decoding="async"
        fetchpriority="low"
        class="not-prose absolute inset-0 w-full h-full object-cover">
    </div>
  
  
  <div class="p-4">
    <header>
      <a
        
          href="/posts/why-care-about-cost/"
        
        class="not-prose before:absolute before:inset-0 decoration-primary-500 dark:text-neutral text-xl font-bold text-neutral-800 hover:underline hover:underline-offset-2">
        <h2>
          Why Care About Cost as Software Engineer?
          
        </h2>
      </a>
    </header>
    <div class="text-sm text-neutral-500 dark:text-neutral-400">
      







  

  
  
  
    
  

  

  
    
  

  

  
    
  

  
    
  

  

  

  

  

  


  <div class="flex flex-row flex-wrap items-center">
    
    
      <time datetime="2024-11-18T00:00:00&#43;00:00">18 November 2024</time><span class="px-2 text-primary-500">&middot;</span><span>574 words</span><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">3 mins</span>
    

    
    
  </div>

  

  
  

  
  



    </div>
    
  </div>
  <div class="px-6 pt-4 pb-2"></div>
</article>

      
    </section>
  


      </div>
    </section>

    
    <footer class="pt-8 max-w-prose print:hidden">
      
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600">
      <div class="flex justify-between pt-3">
        <span class="flex flex-col">
          
            <a
              class="flex text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
              href="/posts/observability-and-guardrails/">
              <span class="leading-6">
                <span class="inline-block rtl:rotate-180">&larr;</span>&ensp;Cost Observability and Guardrails
              </span>
            </a>
            
              <span class="ms-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400">
                <time datetime="2025-02-18T00:00:00&#43;00:00">18 February 2025</time>
              </span>
            
          
        </span>
        <span class="flex flex-col items-end">
          
            <a
              class="flex text-right text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
              href="/posts/substack-to-kindle/">
              <span class="leading-6">
                Replacing SaaS with an Hour of AI Coding&ensp;<span class="inline-block rtl:rotate-180">&rarr;</span>
              </span>
            </a>
            
              <span class="me-6 mt-1 text-xs text-neutral-500 dark:text-neutral-400">
                <time datetime="2026-02-23T00:00:00&#43;00:00">23 February 2026</time>
              </span>
            
          
        </span>
      </div>
    </div>
  


      
    </footer>
  </article>

        


  






<div
  id="scroll-to-top"
  class="fixed bottom-6 end-6 z-50 transform translate-y-4 opacity-0 duration-200">
  <a
    href="#the-top"
    class="pointer-events-auto flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
    aria-label="Scroll to top"
    title="Scroll to top">
    &uarr;
  </a>
</div>

      </main><footer id="site-footer" class="py-10 print:hidden">
  
  
    
  
  <div class="flex items-center justify-between">
    
    
      <p class="text-sm text-neutral-500 dark:text-neutral-400">
          &copy;
          2026
          Paweł Obrępalski
      </p>
    

    
    
      <p class="text-xs text-neutral-500 dark:text-neutral-400">
        
        
        Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
          href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
          href="https://blowfish.page/" target="_blank" rel="noopener noreferrer">Blowfish</a>
      </p>
    
  </div>
  
    <script>
      mediumZoom(document.querySelectorAll("img:not(.nozoom)"), {
        margin: 24,
        background: "rgba(0,0,0,0.5)",
        scrollOffset: 0,
      });
    </script>
  
  
  
</footer>
<div
  id="search-wrapper"
  class="invisible fixed inset-0 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh] z-500"
  data-url="http://localhost:1313/">
  <div
    id="search-modal"
    class="flex flex-col w-full max-w-3xl min-h-0 mx-auto border rounded-md shadow-lg top-20 border-neutral-200 bg-neutral dark:border-neutral-700 dark:bg-neutral-800">
    <header class="relative z-10 flex items-center justify-between flex-none px-2">
      <form class="flex items-center flex-auto min-w-0">
        <div class="flex items-center justify-center w-8 h-8 text-neutral-400">
          <span class="relative block icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span>
        </div>
        <input
          type="search"
          id="search-query"
          class="flex flex-auto h-12 mx-1 bg-transparent appearance-none focus:outline-dotted focus:outline-2 focus:outline-transparent"
          placeholder="Search"
          tabindex="0">
      </form>
      <button
        id="close-search-button"
        class="flex items-center justify-center w-8 h-8 text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"
        title="Close (Esc)">
        <span class="relative block icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="currentColor" d="M310.6 361.4c12.5 12.5 12.5 32.75 0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3L54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75 0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75 0-45.25s32.75-12.5 45.25 0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25 0s12.5 32.75 0 45.25l-105.4 105.4L310.6 361.4z"/></svg>
</span>
      </button>
    </header>
    <section class="flex-auto px-2 overflow-auto">
      <ul id="search-results">
        
      </ul>
    </section>
  </div>
</div>

    </div>
  </body>
  
</html>
